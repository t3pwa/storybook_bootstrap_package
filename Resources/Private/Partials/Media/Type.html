<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
      xmlns:bk2k="http://typo3.org/ns/BK2K/BootstrapPackage/ViewHelpers"
      xmlns:v="http://typo3.org/ns/FluidTYPO3/Vhs/ViewHelpers"
      data-namespace-typo3-fluid="true">
<f:variable name="isImage" value="{file -> bk2k:file.isImage()}" />
<f:variable name="isAudio" value="{file -> bk2k:file.isAudio()}" />
<f:variable name="isMedia" value="{file -> bk2k:file.isMedia()}" />
<f:switch expression="1">
    <f:case value="{isImage}">
        <!-- type is image -->
        <f:render partial="Media/Type/Image" arguments="{file: file, data: data, settings: settings, variants: variants}" />
    </f:case>
    <f:case value="{isAudio}">
        <f:render partial="Media/Type/Audio" arguments="{file: file, data: data, settings: settings}" />
    </f:case>
    <f:case value="{isMedia}">
        <!-- type is Media/Video -->
        <f:render partial="Media/Type/Video" arguments="{file: file, data: data, settings: settings}" />
    </f:case>
    <f:defaultCase>
        <!-- StorybookBootstrapPackage Partial/Media/Type -->
        <!-- NOT SUPPORTED MEDIA TYPE -->

        <f:comment>move the following code to a seperate partial</f:comment>
        <f:comment>
            @ToDo VHS viewhelper pregmatch file extension
            - case switch png, jpg, jpeg, mkv, mp4, webm, webp

            <f:render partial="Media/Type/Video" arguments="{file: file, data: data, settings: settings, variants: variants}" />
            <f:render partial="Media/Type/Image" arguments="{file: file, data: data, settings: settings, variants: variants}" />
        </f:comment>

        <f:variable name="extension">{v:variable.pregMatch(subject:file.properties.src, pattern:'/.*\.((?:jpe?g|png|gif|pdf|svg))(?:\?\S+)?$/i')}</f:variable>
        <f:comment>
            <f:debug>{extension.1}</f:debug>
        </f:comment>
        {extension.1}

        <f:if condition="{file.properties.id}">
            <f:then>
                ID: {file.properties.id}

                <f:switch expression="{extension.1}">

                    <f:case value="mp4">
                        <!-- RENDER MP4 -->
                        <f:render partial="Media/Type/Video" arguments="{file: file, data: data, settings: settings, variants: variants}" />
                    </f:case>

                    <f:defaultCase>

                    </f:defaultCase>
                </f:switch>


            </f:then>
        </f:if>

        <f:if condition="{file.properties.src}">
            <f:then>

                <f:switch expression="{extension.1}">
                    <f:case value="png">
                        <f:comment>
                            <img class="media-rendering-image" loading="lazy" src="{file.properties.src}" data-debug="1" data-extension="{extension.1}">
                        </f:comment>
                        <f:render partial="Media/Type/Image" arguments="{file: file, data: data, settings: settings, variants: variants}" />
                    </f:case>
                    <f:case value="jpg">
                        <!-- RENDER jpg -->
                        <img class="media-rendering-image" loading="lazy" src="{file.properties.src}" data-debug="1" data-extension="{extension.1}">
                        <f:render partial="Media/Type/Image" arguments="{file: file, data: data, settings: settings, variants: variants}" />
                    </f:case>
                    <f:case value="svg">
                        <f:render partial="Media/Type/Image" arguments="{file: file, data: data, settings: settings, variants: variants}" />
                    </f:case>

                    <f:case value="mp4">
                        <!-- RENDER MP4 -->
                        <f:render partial="Media/Type/Video" arguments="{file: file, data: data, settings: settings, variants: variants}" />
                    </f:case>

                    <f:defaultCase>

                    </f:defaultCase>
                </f:switch>
            </f:then>
        </f:if>
    </f:defaultCase>
</f:switch>
</html>
